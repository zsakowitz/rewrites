import { data_v2, SIZE } from "./v2"

const PRECOMPUTED = new Uint16Array([
    1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768,
    2, 3, 8, 12, 32, 48, 128, 192, 512, 768, 2048, 3072, 8192, 12288, 32768,
    49152, 4, 8, 6, 11, 64, 128, 96, 176, 1024, 2048, 1536, 2816, 16384, 32768,
    24576, 45056, 8, 12, 11, 13, 128, 192, 176, 208, 2048, 3072, 2816, 3328,
    32768, 49152, 45056, 53248, 16, 32, 64, 128, 24, 44, 75, 141, 4096, 8192,
    16384, 32768, 6144, 11264, 19200, 36096, 32, 48, 128, 192, 44, 52, 141, 198,
    8192, 12288, 32768, 49152, 11264, 13312, 36096, 50688, 64, 128, 96, 176, 75,
    141, 103, 185, 16384, 32768, 24576, 45056, 19200, 36096, 26368, 47360, 128,
    192, 176, 208, 141, 198, 185, 222, 32768, 49152, 45056, 53248, 36096, 50688,
    47360, 56832, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 384, 704,
    1200, 2256, 4237, 8390, 16569, 32990, 512, 768, 2048, 3072, 8192, 12288,
    32768, 49152, 704, 832, 2256, 3168, 8390, 12363, 32990, 49255, 1024, 2048,
    1536, 2816, 16384, 32768, 24576, 45056, 1200, 2256, 1648, 2960, 16569,
    32990, 24703, 45205, 2048, 3072, 2816, 3328, 32768, 49152, 45056, 53248,
    2256, 3168, 2960, 3552, 32990, 49255, 45205, 53482, 4096, 8192, 16384,
    32768, 6144, 11264, 19200, 36096, 4237, 8390, 16569, 32990, 6237, 11430,
    19241, 36158, 8192, 12288, 32768, 49152, 11264, 13312, 36096, 50688, 8390,
    12363, 32990, 49255, 11430, 13563, 36158, 50711, 16384, 32768, 24576, 45056,
    19200, 36096, 26368, 47360, 16569, 32990, 24703, 45205, 19241, 36158, 26511,
    47557, 32768, 49152, 45056, 53248, 36096, 50688, 47360, 56832, 32990, 49255,
    45205, 53482, 36158, 50711, 47557, 56906,
])

function mul(a: number, b: number): number {
    let res = 0

    for (let i = 0; i < 256; i++) {
        if (a & (1 << (i >> 4)) && b & (1 << (i & 0xf))) {
            res ^= PRECOMPUTED[i]!
        }
    }

    return res
}

console.time("v3")
let ok = false
for (let i = 0; i < SIZE; i++) {
    for (let j = 0; j < SIZE; j++) {
        const res = mul(i, j)
        ok = ok && res == data_v2[i]![j]!
    }
}
console.timeEnd("v3")
